<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù…Ø·ÙˆØ± - ØªÙƒØ§Ù…Ù„ HyperPay</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #0a0e1a;
            --card: #111827;
            --card2: #1a2236;
            --border: rgba(255, 255, 255, .07);
            --purple: #7c3aed;
            --purple-g: linear-gradient(135deg, #7c3aed, #a855f7);
            --green: #10b981;
            --blue: #3b82f6;
            --orange: #f59e0b;
            --red: #ef4444;
            --cyan: #06b6d4;
            --text: #e2e8f0;
            --muted: #94a3b8;
            --dim: #64748b
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box
        }

        body {
            font-family: 'Cairo', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.7;
            padding: 0
        }

        code,
        pre {
            font-family: 'JetBrains Mono', monospace
        }

        .hero {
            background: linear-gradient(135deg, #1a1040 0%, #0f172a 50%, #0c1425 100%);
            padding: 60px 20px;
            text-align: center;
            border-bottom: 1px solid var(--border);
            position: relative;
            overflow: hidden
        }

        .hero::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle at 30% 50%, rgba(124, 58, 237, .08), transparent 50%);
            pointer-events: none
        }

        .hero h1 {
            font-size: 2.4rem;
            font-weight: 800;
            background: var(--purple-g);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px
        }

        .hero p {
            color: var(--muted);
            font-size: 1rem;
            max-width: 600px;
            margin: 0 auto
        }

        .hero .ver {
            display: inline-block;
            background: rgba(124, 58, 237, .15);
            border: 1px solid rgba(124, 58, 237, .3);
            padding: 4px 16px;
            border-radius: 50px;
            font-size: .75rem;
            color: var(--purple);
            margin-bottom: 16px
        }

        .wrap {
            max-width: 960px;
            margin: 0 auto;
            padding: 40px 20px
        }

        .toc {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 28px;
            margin-bottom: 40px
        }

        .toc h3 {
            font-size: 1rem;
            color: var(--purple);
            margin-bottom: 12px
        }

        .toc ol {
            padding-right: 20px
        }

        .toc li {
            margin-bottom: 6px
        }

        .toc a {
            color: var(--blue);
            text-decoration: none;
            font-size: .9rem
        }

        .toc a:hover {
            text-decoration: underline
        }

        section {
            margin-bottom: 48px
        }

        h2 {
            font-size: 1.5rem;
            font-weight: 800;
            color: #fff;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(124, 58, 237, .3);
            display: flex;
            align-items: center;
            gap: 10px
        }

        h2 .num {
            background: var(--purple-g);
            color: #fff;
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: .85rem;
            flex-shrink: 0
        }

        h3 {
            font-size: 1.1rem;
            color: var(--cyan);
            margin: 20px 0 10px
        }

        .card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 14px;
            padding: 24px;
            margin-bottom: 16px
        }

        .card.warn {
            border-color: rgba(245, 158, 11, .3);
            background: rgba(245, 158, 11, .04)
        }

        .card.success {
            border-color: rgba(16, 185, 129, .3);
            background: rgba(16, 185, 129, .04)
        }

        .card.info {
            border-color: rgba(59, 130, 246, .3);
            background: rgba(59, 130, 246, .04)
        }

        pre {
            background: #0d1117;
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 18px;
            overflow-x: auto;
            font-size: .82rem;
            line-height: 1.6;
            margin: 12px 0;
            direction: ltr;
            text-align: left;
            color: #c9d1d9
        }

        .kw {
            color: #ff7b72
        }

        .str {
            color: #a5d6ff
        }

        .cm {
            color: #8b949e
        }

        .fn {
            color: #d2a8ff
        }

        .num {
            color: #79c0ff
        }

        .key {
            color: #ffa657
        }

        .endpoint {
            background: var(--card2);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            margin: 16px 0
        }

        .endpoint .method {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 6px;
            font-size: .75rem;
            font-weight: 700;
            margin-left: 8px;
            font-family: 'JetBrains Mono', monospace
        }

        .method.post {
            background: rgba(16, 185, 129, .15);
            color: var(--green)
        }

        .method.get {
            background: rgba(59, 130, 246, .15);
            color: var(--blue)
        }

        .endpoint .url {
            font-family: 'JetBrains Mono', monospace;
            font-size: .9rem;
            color: #fff
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: .85rem;
            margin: 12px 0
        }

        th,
        td {
            padding: 10px 14px;
            text-align: right;
            border-bottom: 1px solid var(--border)
        }

        th {
            color: var(--purple);
            font-weight: 600;
            background: rgba(124, 58, 237, .05)
        }

        td {
            color: var(--muted)
        }

        td code {
            background: rgba(255, 255, 255, .06);
            padding: 2px 6px;
            border-radius: 4px;
            font-size: .8rem;
            color: var(--cyan)
        }

        .flow {
            display: flex;
            flex-direction: column;
            gap: 0;
            margin: 20px 0
        }

        .flow-step {
            display: flex;
            gap: 16px;
            position: relative
        }

        .flow-step .dot {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: .85rem;
            font-weight: 700;
            flex-shrink: 0;
            position: relative;
            z-index: 1
        }

        .flow-step .line {
            position: absolute;
            right: 17px;
            top: 36px;
            bottom: -36px;
            width: 2px;
            background: var(--border)
        }

        .flow-step:last-child .line {
            display: none
        }

        .flow-step .content {
            flex: 1;
            padding-bottom: 24px
        }

        .flow-step .content h4 {
            font-size: .95rem;
            color: #fff;
            margin-bottom: 4px
        }

        .flow-step .content p {
            font-size: .85rem;
            color: var(--muted)
        }

        .dot.purple {
            background: rgba(124, 58, 237, .2);
            color: var(--purple);
            border: 2px solid var(--purple)
        }

        .dot.blue {
            background: rgba(59, 130, 246, .2);
            color: var(--blue);
            border: 2px solid var(--blue)
        }

        .dot.green {
            background: rgba(16, 185, 129, .2);
            color: var(--green);
            border: 2px solid var(--green)
        }

        .dot.orange {
            background: rgba(245, 158, 11, .2);
            color: var(--orange);
            border: 2px solid var(--orange)
        }

        .badge {
            display: inline-block;
            padding: 2px 10px;
            border-radius: 50px;
            font-size: .7rem;
            font-weight: 600
        }

        .badge.required {
            background: rgba(239, 68, 68, .15);
            color: var(--red)
        }

        .badge.optional {
            background: rgba(100, 116, 139, .15);
            color: var(--dim)
        }

        .footer {
            text-align: center;
            padding: 40px;
            color: var(--dim);
            font-size: .8rem;
            border-top: 1px solid var(--border)
        }
    </style>
</head>

<body>

    <div class="hero">
        <div class="ver">ğŸ“‹ ÙˆØ«ÙŠÙ‚Ø© ØªÙ‚Ù†ÙŠØ© â€” v2.0</div>
        <h1>ğŸ’œ Ø¯Ù„ÙŠÙ„ ØªÙƒØ§Ù…Ù„ HyperPay</h1>
        <p>Ø¯Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ Ù„Ù…Ø·ÙˆØ± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù„ØªÙ†ÙÙŠØ° Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¯ÙØ¹ Ø¹Ø¨Ø± HyperPay Ù…Ù† Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ø­ØªÙ‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</p>
    </div>

    <div class="wrap">

        <!-- TOC -->
        <div class="toc">
            <h3>ğŸ“‘ Ø§Ù„ÙÙ‡Ø±Ø³</h3>
            <ol>
                <li><a href="#arch">Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„Ø¹Ø§Ù…Ø© ÙˆØ³ÙŠØ± Ø§Ù„Ø¹Ù…Ù„</a></li>
                <li><a href="#step1">Ø§Ù„Ø®Ø·ÙˆØ© 1: Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¯ÙØ¹ (Initiate)</a></li>
                <li><a href="#step2">Ø§Ù„Ø®Ø·ÙˆØ© 2: Ø¹Ø±Ø¶ Payment Widget</a></li>
                <li><a href="#step3">Ø§Ù„Ø®Ø·ÙˆØ© 3: Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¯ÙØ¹ (Verify)</a></li>
                <li><a href="#backend">Ù…Ø§Ø°Ø§ ÙŠØ­Ø¯Ø« ÙÙŠ Ø§Ù„Ø®Ø§Ø¯Ù… Ø¨Ø¹Ø¯ Ø§Ù„Ù†Ø¬Ø§Ø­</a></li>
                <li><a href="#db">Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª â€” Ø¬Ø¯ÙˆÙ„ payments</a></li>
                <li><a href="#errors">Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ ÙˆØ±Ù…ÙˆØ² Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©</a></li>
                <li><a href="#test">Ø¨ÙŠØ¦Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙˆØ¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„ØªØ¬Ø±Ø¨Ø©</a></li>
                <li><a href="#checklist">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</a></li>
            </ol>
        </div>

        <!-- 1. Architecture -->
        <section id="arch">
            <h2><span class="num">1</span> Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„Ø¹Ø§Ù…Ø© ÙˆØ³ÙŠØ± Ø§Ù„Ø¹Ù…Ù„</h2>

            <div class="card info">
                <p>âš¡ HyperPay ÙŠØ®ØªÙ„Ù Ø¹Ù† Tabby/Tamara â€” Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡ Ù„ØµÙØ­Ø© Ø®Ø§Ø±Ø¬ÙŠØ©. Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø°Ù„ÙƒØŒ ÙŠØªÙ… ØªØ¶Ù…ÙŠÙ†
                    <strong>Payment Widget</strong> Ø¯Ø§Ø®Ù„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… WebView.</p>
            </div>

            <div class="flow">
                <div class="flow-step">
                    <div class="dot purple">1</div>
                    <div class="line"></div>
                    <div class="content">
                        <h4>Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ â†’ POST /api/payment/initiate</h4>
                        <p>Ø¥Ø±Ø³Ø§Ù„ booking_id Ùˆ payment_type (mada Ø£Ùˆ visa_master) â† ÙŠØ¹ÙˆØ¯ checkout_id</p>
                    </div>
                </div>
                <div class="flow-step">
                    <div class="dot blue">2</div>
                    <div class="line"></div>
                    <div class="content">
                        <h4>Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ â†’ Ø¹Ø±Ø¶ Payment Widget ÙÙŠ WebView</h4>
                        <p>ØªØ­Ù…ÙŠÙ„ paymentWidgets.js Ù…Ø¹ checkout_id â† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©</p>
                    </div>
                </div>
                <div class="flow-step">
                    <div class="dot orange">3</div>
                    <div class="line"></div>
                    <div class="content">
                        <h4>HyperPay â†’ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ shopperResultUrl</h4>
                        <p>Ø¨Ø¹Ø¯ Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø¯ÙØ¹ØŒ HyperPay ÙŠÙˆØ¬Ù‡ Ø¥Ù„Ù‰ Ø§Ù„Ù€ URL Ø§Ù„Ù…Ø­Ø¯Ø¯ Ù…Ø¹ ?id=checkout_id&resourcePath=...</p>
                    </div>
                </div>
                <div class="flow-step">
                    <div class="dot green">4</div>
                    <div class="line"></div>
                    <div class="content">
                        <h4>Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ â†’ POST /api/payment/verify</h4>
                        <p>Ø¥Ø±Ø³Ø§Ù„ checkout_id Ùˆ payment_type â† Ø§Ù„Ø®Ø§Ø¯Ù… ÙŠØªØ­Ù‚Ù‚ ÙˆÙŠØ³Ø¬Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© â† ÙŠØ¹ÙˆØ¯ Ø§Ù„Ù†ØªÙŠØ¬Ø© + Ø§Ù„ÙØ§ØªÙˆØ±Ø©</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- 2. Step 1: Initiate -->
        <section id="step1">
            <h2><span class="num">2</span> Ø§Ù„Ø®Ø·ÙˆØ© 1: Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¯ÙØ¹</h2>

            <div class="endpoint">
                <span class="method post">POST</span>
                <span class="url">/api/payment/initiate</span>
                <p style="color:var(--muted);font-size:.8rem;margin-top:6px">ğŸ”’ ÙŠØªØ·Ù„Ø¨ Authorization: Bearer {token}</p>
            </div>

            <h3>ğŸ“¤ Request Body</h3>
            <table>
                <thead>
                    <tr>
                        <th>Ø§Ù„Ø­Ù‚Ù„</th>
                        <th>Ø§Ù„Ù†ÙˆØ¹</th>
                        <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                        <th>Ø§Ù„ÙˆØµÙ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>booking_id</code></td>
                        <td>integer</td>
                        <td><span class="badge required">Ù…Ø·Ù„ÙˆØ¨</span></td>
                        <td>Ù…Ø¹Ø±Ù Ø§Ù„Ø­Ø¬Ø²</td>
                    </tr>
                    <tr>
                        <td><code>payment_type</code></td>
                        <td>string</td>
                        <td><span class="badge required">Ù…Ø·Ù„ÙˆØ¨</span></td>
                        <td><code>mada</code> Ø£Ùˆ <code>visa_master</code> Ø£Ùˆ <code>apple_pay</code></td>
                    </tr>
                </tbody>
            </table>

            <h3>ğŸ“¥ Ù…Ø«Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</h3>
            <pre>{
  <span class="key">"booking_id"</span>: <span class="num">42</span>,
  <span class="key">"payment_type"</span>: <span class="str">"visa_master"</span>
}</pre>

            <h3>âœ… Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­ (200)</h3>
            <pre>{
  <span class="key">"error"</span>: <span class="kw">false</span>,
  <span class="key">"message"</span>: <span class="str">"Checkout initialized successfully."</span>,
  <span class="key">"data"</span>: {
    <span class="key">"id"</span>: <span class="str">"A1B2C3D4E5F6G7H8.uat"</span>,  <span class="cm">// â† Ù‡Ø°Ø§ Ù‡Ùˆ checkout_id</span>
    <span class="key">"result"</span>: {
      <span class="key">"code"</span>: <span class="str">"000.200.100"</span>,
      <span class="key">"description"</span>: <span class="str">"successfully created checkout"</span>
    }
  }
}</pre>

            <div class="card warn">
                <p>âš ï¸ <strong>Ù…Ù‡Ù…:</strong> Ø§Ø­ÙØ¸ Ù‚ÙŠÙ…Ø© <code>data.id</code> â€” Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ù€ <code>checkout_id</code> Ø§Ù„Ø°ÙŠ
                    Ø³ØªØ­ØªØ§Ø¬Ù‡ ÙÙŠ Ø§Ù„Ø®Ø·ÙˆØ© 2 (Ø§Ù„Ø¹Ø±Ø¶) ÙˆØ§Ù„Ø®Ø·ÙˆØ© 3 (Ø§Ù„ØªØ­Ù‚Ù‚).</p>
            </div>

            <h3>Ù…Ø§Ø°Ø§ ÙŠØ­Ø¯Ø« ÙÙŠ Ø§Ù„Ù€ Backend</h3>
            <p>Ø§Ù„Ø®Ø§Ø¯Ù… ÙŠØ±Ø³Ù„ Ø·Ù„Ø¨ POST Ø¥Ù„Ù‰ HyperPay Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹:</p>
            <table>
                <thead>
                    <tr>
                        <th>Ø§Ù„Ù…Ø¹Ø§Ù…Ù„</th>
                        <th>Ø§Ù„Ù‚ÙŠÙ…Ø©</th>
                        <th>Ù…Ù„Ø§Ø­Ø¸Ø©</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>entityId</code></td>
                        <td>Ø­Ø³Ø¨ payment_type</td>
                        <td>ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø±Ù‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</td>
                    </tr>
                    <tr>
                        <td><code>amount</code></td>
                        <td>Ù…Ù† Ø§Ù„Ø­Ø¬Ø²</td>
                        <td>total_price</td>
                    </tr>
                    <tr>
                        <td><code>currency</code></td>
                        <td>SAR</td>
                        <td>Ø«Ø§Ø¨Øª</td>
                    </tr>
                    <tr>
                        <td><code>paymentType</code></td>
                        <td>DB</td>
                        <td>Debit Ù…Ø¨Ø§Ø´Ø±</td>
                    </tr>
                    <tr>
                        <td><code>testMode</code></td>
                        <td>EXTERNAL</td>
                        <td>Ø¨ÙŠØ¦Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙÙ‚Ø·</td>
                    </tr>
                    <tr>
                        <td><code>customParameters[3DS2_enrolled]</code></td>
                        <td>true</td>
                        <td>Ø¨ÙŠØ¦Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙÙ‚Ø·</td>
                    </tr>
                    <tr>
                        <td><code>merchantTransactionId</code></td>
                        <td>BOOKING-{id}-{time}</td>
                        <td>Ù…Ø¹Ø±Ù ÙØ±ÙŠØ¯</td>
                    </tr>
                    <tr>
                        <td><code>customer.email</code></td>
                        <td>Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</td>
                        <td>ØªÙ„Ù‚Ø§Ø¦ÙŠ</td>
                    </tr>
                    <tr>
                        <td><code>customer.givenName</code></td>
                        <td>Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„</td>
                        <td>ØªÙ„Ù‚Ø§Ø¦ÙŠ</td>
                    </tr>
                    <tr>
                        <td><code>customer.surname</code></td>
                        <td>Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£Ø®ÙŠØ±</td>
                        <td>ØªÙ„Ù‚Ø§Ø¦ÙŠ</td>
                    </tr>
                    <tr>
                        <td><code>billing.*</code></td>
                        <td>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„</td>
                        <td>street1, city, state, country, postcode</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- 3. Step 2: Widget -->
        <section id="step2">
            <h2><span class="num">3</span> Ø§Ù„Ø®Ø·ÙˆØ© 2: Ø¹Ø±Ø¶ Payment Widget</h2>

            <div class="card info">
                <p>ğŸ’¡ ÙŠØ¬Ø¨ ÙØªØ­ WebView ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ØµÙØ­Ø© HTML ØªØ­Ù…Ù‘Ù„ Ø³ÙƒØ±ÙŠØ¨Øª HyperPay ÙˆØªØ¹Ø±Ø¶ Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©.
                </p>
            </div>

            <h3>ÙƒÙˆØ¯ HTML Ù„Ù„Ù€ WebView</h3>
            <pre><span class="cm">&lt;!-- 1. Ø£Ø¶Ù Ù‡Ø°Ø§ Ø§Ù„Ø³ÙƒØ±ÙŠØ¨Øª Ø£ÙˆÙ„Ø§Ù‹ --&gt;</span>
&lt;script&gt;
  var wpwlOptions = {
    paymentTarget: "_top",  <span class="cm">// Ù…Ø·Ù„ÙˆØ¨ Ù„Ù€ 3DS</span>
    locale: "ar"
  };
&lt;/script&gt;

<span class="cm">&lt;!-- 2. Ø­Ù…Ù‘Ù„ Ø³ÙƒØ±ÙŠØ¨Øª HyperPay Ù…Ø¹ checkout_id --&gt;</span>
&lt;script src="https://eu-test.oppwa.com/v1/paymentWidgets.js
  ?checkoutId=<span class="str">{CHECKOUT_ID}</span>"&gt;&lt;/script&gt;

<span class="cm">&lt;!-- 3. Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¯ÙØ¹ --&gt;</span>
&lt;form action="<span class="str">{YOUR_RESULT_URL}</span>"
      class="paymentWidgets"
      data-brands="VISA MASTER MADA"&gt;
&lt;/form&gt;</pre>

            <div class="card warn">
                <p>âš ï¸ <strong>shopperResultUrl (action):</strong> Ù‡ÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„ØªÙŠ ÙŠÙˆØ¬Ù‡ Ø¥Ù„ÙŠÙ‡Ø§ HyperPay Ø¨Ø¹Ø¯ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø¯ÙØ¹.
                    ÙŠØ¬Ø¨ Ø£Ù† ØªØ±Ø§Ù‚Ø¨Ù‡Ø§ WebView Ù„Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„Ù€ <code>id</code> parameter Ù…Ù† Ø§Ù„Ù€ URL.</p>
            </div>

            <h3>Ø¢Ù„ÙŠØ© Ø§Ù„Ø¹Ù…Ù„ ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ (Flutter/Native)</h3>
            <pre><span class="cm">// Pseudo-code for mobile app</span>

<span class="cm">// 1. Ø¥Ù†Ø´Ø§Ø¡ checkout</span>
response = POST "/api/payment/initiate" {booking_id, payment_type}
checkoutId = response.data.id

<span class="cm">// 2. ÙØªØ­ WebView Ù…Ø¹ ØµÙØ­Ø© ØªØ­Ù…Ù„ paymentWidgets.js</span>
<span class="cm">//    action URL = "https://yoursite.com/payment/callback?gateway=hyperpay"</span>

<span class="cm">// 3. Ù…Ø±Ø§Ù‚Ø¨Ø© WebView â€” Ø¹Ù†Ø¯ Ø§Ù„ØªÙˆØ¬Ù‡ Ø¥Ù„Ù‰ shopperResultUrl</span>
<span class="cm">//    Ø§Ù„ØªÙ‚Ø· Ø§Ù„Ù€ id Ù…Ù† URL parameters</span>
onUrlChanged(url) {
  <span class="kw">if</span> (url.contains(<span class="str">"payment/callback"</span>)) {
    capturedCheckoutId = url.queryParam(<span class="str">"id"</span>)
    <span class="cm">// 4. Ø£Ø±Ø³Ù„ Ø·Ù„Ø¨ Ø§Ù„ØªØ­Ù‚Ù‚</span>
    POST "/api/payment/verify" {
      checkout_id: capturedCheckoutId,
      payment_type: selectedPaymentType
    }
  }
}</pre>

            <div class="card">
                <p>ğŸ”‘ <strong>Base URL Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±:</strong> <code>https://eu-test.oppwa.com</code></p>
                <p>ğŸ”‘ <strong>Base URL Ù„Ù„Ø¥Ù†ØªØ§Ø¬:</strong> Ø³ÙŠØªÙ… ØªÙˆÙÙŠØ±Ù‡ Ù…Ù† HyperPay Ø¹Ù†Ø¯ Ø§Ù„ØªÙØ¹ÙŠÙ„</p>
            </div>
        </section>

        <!-- 4. Step 3: Verify -->
        <section id="step3">
            <h2><span class="num">4</span> Ø§Ù„Ø®Ø·ÙˆØ© 3: Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¯ÙØ¹</h2>

            <div class="endpoint">
                <span class="method post">POST</span>
                <span class="url">/api/payment/verify</span>
                <p style="color:var(--muted);font-size:.8rem;margin-top:6px">ğŸ”’ ÙŠØªØ·Ù„Ø¨ Authorization: Bearer {token}</p>
            </div>

            <h3>ğŸ“¤ Request Body</h3>
            <table>
                <thead>
                    <tr>
                        <th>Ø§Ù„Ø­Ù‚Ù„</th>
                        <th>Ø§Ù„Ù†ÙˆØ¹</th>
                        <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                        <th>Ø§Ù„ÙˆØµÙ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>checkout_id</code></td>
                        <td>string</td>
                        <td><span class="badge required">Ù…Ø·Ù„ÙˆØ¨</span></td>
                        <td>Ø§Ù„Ù€ checkout_id Ù…Ù† Ø§Ù„Ø®Ø·ÙˆØ© 1 (Ø£Ùˆ Ù…Ù† URL Ø¨Ø¹Ø¯ Widget)</td>
                    </tr>
                    <tr>
                        <td><code>payment_type</code></td>
                        <td>string</td>
                        <td><span class="badge required">Ù…Ø·Ù„ÙˆØ¨</span></td>
                        <td><code>mada</code> Ø£Ùˆ <code>visa_master</code> Ø£Ùˆ <code>apple_pay</code></td>
                    </tr>
                </tbody>
            </table>

            <h3>ğŸ“¥ Ù…Ø«Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</h3>
            <pre>{
  <span class="key">"checkout_id"</span>: <span class="str">"A1B2C3D4E5F6G7H8.uat"</span>,
  <span class="key">"payment_type"</span>: <span class="str">"visa_master"</span>
}</pre>

            <h3>âœ… Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­ (200)</h3>
            <pre>{
  <span class="key">"error"</span>: <span class="kw">false</span>,
  <span class="key">"message"</span>: <span class="str">"Payment successful and booking confirmed."</span>,
  <span class="key">"data"</span>: {
    <span class="key">"status"</span>: <span class="str">"paid"</span>,
    <span class="key">"transaction_id"</span>: <span class="str">"A1B2C3D4E5F6G7H8.uat"</span>,
    <span class="key">"invoice_url"</span>: <span class="str">"https://site.com/storage/invoices/inv_42.pdf"</span>,
    <span class="key">"raw_response"</span>: { <span class="cm">/* Ø¨ÙŠØ§Ù†Ø§Øª HyperPay Ø§Ù„ÙƒØ§Ù…Ù„Ø© */</span> }
  }
}</pre>

            <h3>âŒ Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„ÙØ´Ù„ (400)</h3>
            <pre>{
  <span class="key">"error"</span>: <span class="kw">true</span>,
  <span class="key">"message"</span>: <span class="str">"transaction declined"</span>,
  <span class="key">"data"</span>: { <span class="cm">/* Ø¨ÙŠØ§Ù†Ø§Øª HyperPay Ù…Ø¹ result.code */</span> }
}</pre>
        </section>

        <!-- 5. Backend Logic -->
        <section id="backend">
            <h2><span class="num">5</span> Ù…Ø§Ø°Ø§ ÙŠØ­Ø¯Ø« ÙÙŠ Ø§Ù„Ø®Ø§Ø¯Ù… Ø¨Ø¹Ø¯ Ù†Ø¬Ø§Ø­ Ø§Ù„Ø¯ÙØ¹</h2>
            <p>Ø¹Ù†Ø¯ Ù†Ø¬Ø§Ø­ Ø§Ù„ØªØ­Ù‚Ù‚ØŒ ÙŠØªÙ… Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø¯Ø§Ù„Ø© <code>completePayment()</code> Ø§Ù„ØªÙŠ ØªÙ†ÙØ° Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨:</p>

            <div class="flow">
                <div class="flow-step">
                    <div class="dot purple">1</div>
                    <div class="line"></div>
                    <div class="content">
                        <h4>ÙØ­Øµ Idempotency</h4>
                        <p>Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø­Ø¬Ø² Ù…Ø¤ÙƒØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹ â†’ ÙŠØ¹ÙŠØ¯ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø¨Ø¯ÙˆÙ† ØªÙƒØ±Ø§Ø± Ø§Ù„Ø¹Ù…Ù„ÙŠØ© (Ø­Ù…Ø§ÙŠØ© Ù…Ù† Ø§Ù„Ø·Ù„Ø¨Ø§Øª
                            Ø§Ù„Ù…ÙƒØ±Ø±Ø©)</p>
                    </div>
                </div>
                <div class="flow-step">
                    <div class="dot blue">2</div>
                    <div class="line"></div>
                    <div class="content">
                        <h4>Ø®ØµÙ… Ø§Ù„ØªØ°Ø§ÙƒØ± Ù…Ù† Ø§Ù„Ø±Ø­Ù„Ø©</h4>
                        <p><code>trip.tickets -= booking.tickets_count</code> â€” Ù…Ø¹ ØªØ³Ø¬ÙŠÙ„ ØªØ­Ø°ÙŠØ± Ø¥Ø°Ø§ Ø­ØµÙ„ Overbooking</p>
                    </div>
                </div>
                <div class="flow-step">
                    <div class="dot orange">3</div>
                    <div class="line"></div>
                    <div class="content">
                        <h4>ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø¬Ø²</h4>
                        <p><code>booking.status = 'confirmed'</code></p>
                    </div>
                </div>
                <div class="flow-step">
                    <div class="dot green">4</div>
                    <div class="line"></div>
                    <div class="content">
                        <h4>ØªØ³Ø¬ÙŠÙ„ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¯ÙØ¹</h4>
                        <p>Ø¥Ù†Ø´Ø§Ø¡ Ø³Ø¬Ù„ Ø¬Ø¯ÙŠØ¯ ÙÙŠ Ø¬Ø¯ÙˆÙ„ <code>payments</code> Ø¨ÙƒØ§Ù…Ù„ Ø§Ù„ØªÙØ§ØµÙŠÙ„ (gateway, transaction_id, amount,
                            raw_response)</p>
                    </div>
                </div>
                <div class="flow-step">
                    <div class="dot purple">5</div>
                    <div class="line"></div>
                    <div class="content">
                        <h4>Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙØ§ØªÙˆØ±Ø©</h4>
                        <p>ØªÙˆÙ„ÙŠØ¯ Ù…Ù„Ù PDF Ù„Ù„ÙØ§ØªÙˆØ±Ø© ÙˆØ­ÙØ¸ Ù…Ø³Ø§Ø±Ù‡ ÙÙŠ <code>invoice_path</code></p>
                    </div>
                </div>
            </div>

            <h3>Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ â€” completePayment()</h3>
            <pre><span class="kw">protected function</span> <span class="fn">completePayment</span>($bookingId, $gateway, $transactionId, $response, $paymentMethod)
{
    $booking = TripBooking::with(<span class="str">'trip'</span>)->find($bookingId);

    <span class="cm">// 1. Idempotency check</span>
    <span class="kw">if</span> ($booking->status === <span class="str">'confirmed'</span>) {
        <span class="kw">return</span> Payment::where(<span class="str">'trip_booking_id'</span>, $bookingId)->first()->invoice_path;
    }

    <span class="cm">// 2. Deduct tickets</span>
    $newCount = max(<span class="num">0</span>, $booking->trip->tickets - $booking->tickets_count);
    $booking->trip->update([<span class="str">'tickets'</span> => $newCount]);

    <span class="cm">// 3. Confirm booking</span>
    $booking->update([<span class="str">'status'</span> => <span class="str">'confirmed'</span>]);

    <span class="cm">// 4. Record payment</span>
    $payment = Payment::create([
        <span class="str">'trip_booking_id'</span>  => $booking->id,
        <span class="str">'payment_gateway'</span> => $gateway,      <span class="cm">// 'hyperpay'</span>
        <span class="str">'payment_method'</span>  => $paymentMethod, <span class="cm">// 'mada' | 'visa_master'</span>
        <span class="str">'transaction_id'</span>  => $transactionId, <span class="cm">// checkout_id</span>
        <span class="str">'amount'</span>          => $booking->total_price,
        <span class="str">'currency'</span>        => <span class="str">'SAR'</span>,
        <span class="str">'status'</span>          => <span class="str">'paid'</span>,
        <span class="str">'raw_response'</span>    => $response,
    ]);

    <span class="cm">// 5. Generate invoice PDF</span>
    $invoicePath = $this->invoiceService->generateInvoice($booking);
    $payment->update([<span class="str">'invoice_path'</span> => $invoicePath]);

    <span class="kw">return</span> $invoicePath;
}</pre>
        </section>

        <!-- 6. Database -->
        <section id="db">
            <h2><span class="num">6</span> Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª â€” Ø¬Ø¯ÙˆÙ„ payments</h2>
            <table>
                <thead>
                    <tr>
                        <th>Ø§Ù„Ø¹Ù…ÙˆØ¯</th>
                        <th>Ø§Ù„Ù†ÙˆØ¹</th>
                        <th>Ø§Ù„ÙˆØµÙ</th>
                        <th>Ù…Ø«Ø§Ù„</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>id</code></td>
                        <td>bigint</td>
                        <td>Ø§Ù„Ù…Ø¹Ø±Ù</td>
                        <td>1</td>
                    </tr>
                    <tr>
                        <td><code>trip_booking_id</code></td>
                        <td>bigint FK</td>
                        <td>Ù…Ø¹Ø±Ù Ø§Ù„Ø­Ø¬Ø²</td>
                        <td>42</td>
                    </tr>
                    <tr>
                        <td><code>payment_gateway</code></td>
                        <td>enum</td>
                        <td>Ø§Ù„Ø¨ÙˆØ§Ø¨Ø©</td>
                        <td><code>hyperpay</code></td>
                    </tr>
                    <tr>
                        <td><code>payment_method</code></td>
                        <td>string</td>
                        <td>Ø§Ù„Ø·Ø±ÙŠÙ‚Ø©</td>
                        <td><code>mada</code> / <code>visa_master</code></td>
                    </tr>
                    <tr>
                        <td><code>transaction_id</code></td>
                        <td>string</td>
                        <td>Ù…Ø¹Ø±Ù Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</td>
                        <td><code>A1B2C3...</code></td>
                    </tr>
                    <tr>
                        <td><code>amount</code></td>
                        <td>decimal</td>
                        <td>Ø§Ù„Ù…Ø¨Ù„Øº</td>
                        <td>500.00</td>
                    </tr>
                    <tr>
                        <td><code>currency</code></td>
                        <td>string</td>
                        <td>Ø§Ù„Ø¹Ù…Ù„Ø©</td>
                        <td>SAR</td>
                    </tr>
                    <tr>
                        <td><code>status</code></td>
                        <td>enum</td>
                        <td>Ø§Ù„Ø­Ø§Ù„Ø©</td>
                        <td><code>paid</code></td>
                    </tr>
                    <tr>
                        <td><code>raw_response</code></td>
                        <td>JSON</td>
                        <td>Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©</td>
                        <td>{...}</td>
                    </tr>
                    <tr>
                        <td><code>invoice_path</code></td>
                        <td>string</td>
                        <td>Ù…Ø³Ø§Ø± Ø§Ù„ÙØ§ØªÙˆØ±Ø©</td>
                        <td>invoices/inv_42.pdf</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- 7. Errors -->
        <section id="errors">
            <h2><span class="num">7</span> Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ ÙˆØ±Ù…ÙˆØ² Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©</h2>

            <h3>Ø±Ù…ÙˆØ² Ø§Ù„Ù†Ø¬Ø§Ø­ (HyperPay result.code)</h3>
            <table>
                <thead>
                    <tr>
                        <th>Ø§Ù„Ù†Ù…Ø·</th>
                        <th>Ø§Ù„Ù…Ø¹Ù†Ù‰</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>000.000.xxx</code></td>
                        <td>Ø¹Ù…Ù„ÙŠØ© Ù†Ø§Ø¬Ø­Ø©</td>
                    </tr>
                    <tr>
                        <td><code>000.100.1xx</code></td>
                        <td>Ø¹Ù…Ù„ÙŠØ© Ù†Ø§Ø¬Ø­Ø© (Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ù…Ø¹Ø§Ù„Ø¬Ø©)</td>
                    </tr>
                    <tr>
                        <td><code>000.3xx.xxx</code></td>
                        <td>Ø¹Ù…Ù„ÙŠØ© Ù†Ø§Ø¬Ø­Ø© (ØªØ­ØªØ§Ø¬ Ù…Ø±Ø§Ø¬Ø¹Ø©)</td>
                    </tr>
                    <tr>
                        <td><code>000.6xx.xxx</code></td>
                        <td>Ø¹Ù…Ù„ÙŠØ© Ù†Ø§Ø¬Ø­Ø© (ØªØ­ØªØ§Ø¬ Ù…Ø±Ø§Ø¬Ø¹Ø©)</td>
                    </tr>
                </tbody>
            </table>

            <h3>Ø±Ù…ÙˆØ² Ø§Ù„ÙØ´Ù„ Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©</h3>
            <table>
                <thead>
                    <tr>
                        <th>Ø§Ù„Ø±Ù…Ø²</th>
                        <th>Ø§Ù„Ù…Ø¹Ù†Ù‰</th>
                        <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>800.100.151</code></td>
                        <td>Ø¨Ø·Ø§Ù‚Ø© ØºÙŠØ± ØµØ§Ù„Ø­Ø©</td>
                        <td>Ø§Ø·Ù„Ø¨ Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</td>
                    </tr>
                    <tr>
                        <td><code>800.100.152</code></td>
                        <td>Ø¹Ù…Ù„ÙŠØ© Ù…Ø±ÙÙˆØ¶Ø©</td>
                        <td>Ø§Ø·Ù„Ø¨ Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¨Ù†Ùƒ</td>
                    </tr>
                    <tr>
                        <td><code>100.100.303</code></td>
                        <td>Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙŠ</td>
                        <td>Ø¥Ø¨Ù„Ø§Øº Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</td>
                    </tr>
                    <tr>
                        <td><code>700.400.200</code></td>
                        <td>Checkout Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©</td>
                        <td>Ø£Ø¹Ø¯ Ø¥Ù†Ø´Ø§Ø¡ checkout Ø¬Ø¯ÙŠØ¯</td>
                    </tr>
                </tbody>
            </table>

            <h3>Ø£ÙƒÙˆØ§Ø¯ HTTP Ù…Ù† Ø§Ù„Ù€ API</h3>
            <table>
                <thead>
                    <tr>
                        <th>Ø§Ù„ÙƒÙˆØ¯</th>
                        <th>Ø§Ù„Ù…Ø¹Ù†Ù‰</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>200</code></td>
                        <td>Ù†Ø¬Ø§Ø­ â€” Ø§Ù„Ø¯ÙØ¹ ØªÙ… ÙˆØªÙ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø²</td>
                    </tr>
                    <tr>
                        <td><code>400</code></td>
                        <td>ÙØ´Ù„ Ø§Ù„Ø¯ÙØ¹ Ø£Ùˆ ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</td>
                    </tr>
                    <tr>
                        <td><code>422</code></td>
                        <td>Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ (Ø­Ù‚ÙˆÙ„ Ù…ÙÙ‚ÙˆØ¯Ø©)</td>
                    </tr>
                    <tr>
                        <td><code>500</code></td>
                        <td>Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø®Ø§Ø¯Ù…</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- 8. Test -->
        <section id="test">
            <h2><span class="num">8</span> Ø¨ÙŠØ¦Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h2>

            <div class="card success">
                <p>âœ… <strong>ØªÙ… Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¯ÙØ¹ Ø¨Ù†Ø¬Ø§Ø­</strong> Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ØµÙØ­Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ø¯Ù…Ø¬Ø© ÙÙŠ
                    <code>/hyperpay-test</code></p>
            </div>

            <h3>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h3>
            <table>
                <thead>
                    <tr>
                        <th>Ø§Ù„Ù…Ø¹Ø§Ù…Ù„</th>
                        <th>Ø§Ù„Ù‚ÙŠÙ…Ø©</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Base URL</td>
                        <td><code>https://eu-test.oppwa.com/v1/</code></td>
                    </tr>
                    <tr>
                        <td>Access Token</td>
                        <td><code>OGFjN2E0Yzc5NDgzMDky...YWo=</code></td>
                    </tr>
                    <tr>
                        <td>Entity ID</td>
                        <td><code>8ac7a4c79483092601948366b9d1011b</code></td>
                    </tr>
                    <tr>
                        <td>Currency</td>
                        <td>SAR ÙÙ‚Ø·</td>
                    </tr>
                    <tr>
                        <td>Payment Type</td>
                        <td>DB ÙÙ‚Ø·</td>
                    </tr>
                </tbody>
            </table>

            <h3>Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h3>
            <table>
                <thead>
                    <tr>
                        <th>Ø§Ù„Ù†ÙˆØ¹</th>
                        <th>Ø§Ù„Ø±Ù‚Ù…</th>
                        <th>Ø§Ù†ØªÙ‡Ø§Ø¡</th>
                        <th>CVV</th>
                        <th>Ø§Ù„Ù†ØªÙŠØ¬Ø©</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Visa</td>
                        <td><code>4440000009900010</code></td>
                        <td>01/39</td>
                        <td>100</td>
                        <td style="color:var(--green)">âœ… Ù†Ø¬Ø§Ø­</td>
                    </tr>
                    <tr>
                        <td>MasterCard</td>
                        <td><code>5123450000000008</code></td>
                        <td>01/39</td>
                        <td>100</td>
                        <td style="color:var(--green)">âœ… Ù†Ø¬Ø§Ø­</td>
                    </tr>
                    <tr>
                        <td>MADA</td>
                        <td><code>4464040000000007</code></td>
                        <td>12/25</td>
                        <td>100</td>
                        <td style="color:var(--green)">âœ… Ù†Ø¬Ø§Ø­</td>
                    </tr>
                </tbody>
            </table>

            <div class="card warn">
                <p>âš ï¸ <strong>Ù…Ù„Ø§Ø­Ø¸Ø©:</strong> ÙÙŠ Ø¨ÙŠØ¦Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±ØŒ ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø§Ù„Ù…Ø¨Ø§Ù„Øº Ø¨Ø¯ÙˆÙ† ÙƒØ³ÙˆØ± (Ù…Ø«Ù„ <code>100.00</code>
                    ÙˆÙ„ÙŠØ³ <code>99.50</code>)</p>
            </div>
        </section>

        <!-- 9. Checklist -->
        <section id="checklist">
            <h2><span class="num">9</span> Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù„Ù…Ø·ÙˆØ± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</h2>
            <div class="card">
                <table>
                    <tbody>
                        <tr>
                            <td>â˜</td>
                            <td>Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ <code>POST /api/payment/initiate</code> Ù…Ø¹ <code>booking_id</code> Ùˆ
                                <code>payment_type</code></td>
                        </tr>
                        <tr>
                            <td>â˜</td>
                            <td>Ø­ÙØ¸ <code>data.id</code> (checkout_id) Ù…Ù† Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©</td>
                        </tr>
                        <tr>
                            <td>â˜</td>
                            <td>ÙØªØ­ WebView ÙŠØ­Ù…Ù‘Ù„ <code>paymentWidgets.js?checkoutId={id}</code></td>
                        </tr>
                        <tr>
                            <td>â˜</td>
                            <td>Ø¥Ø¶Ø§ÙØ© <code>wpwlOptions = { paymentTarget: "_top" }</code> Ù‚Ø¨Ù„ Ø³ÙƒØ±ÙŠØ¨Øª HyperPay</td>
                        </tr>
                        <tr>
                            <td>â˜</td>
                            <td>ØªØ­Ø¯ÙŠØ¯ <code>data-brands="VISA MASTER MADA"</code></td>
                        </tr>
                        <tr>
                            <td>â˜</td>
                            <td>Ù…Ø±Ø§Ù‚Ø¨Ø© URL ÙÙŠ WebView Ù„Ø§Ù„ØªÙ‚Ø§Ø· checkout_id Ø¨Ø¹Ø¯ Ø§Ù„Ø¯ÙØ¹</td>
                        </tr>
                        <tr>
                            <td>â˜</td>
                            <td>Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ <code>POST /api/payment/verify</code> Ù…Ø¹ <code>checkout_id</code> Ùˆ
                                <code>payment_type</code></td>
                        </tr>
                        <tr>
                            <td>â˜</td>
                            <td>Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©: <code>error: false</code> = Ù†Ø¬Ø§Ø­ØŒ <code>error: true</code> = ÙØ´Ù„</td>
                        </tr>
                        <tr>
                            <td>â˜</td>
                            <td>Ø¹Ø±Ø¶ <code>invoice_url</code> Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ù†Ø¯ Ø§Ù„Ù†Ø¬Ø§Ø­</td>
                        </tr>
                        <tr>
                            <td>â˜</td>
                            <td>Ù…Ø¹Ø§Ù„Ø¬Ø© Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ø´Ø¨ÙƒØ© ÙˆØ§Ù†ØªÙ‡Ø§Ø¡ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ù€ checkout</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

    </div>

    <div class="footer">
        <p>ğŸ“‹ ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ø¯Ù„ÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ â€” Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: 16 ÙØ¨Ø±Ø§ÙŠØ± 2026</p>
        <p>wjhtak-site Payment Integration Documentation</p>
    </div>

</body>

</html>